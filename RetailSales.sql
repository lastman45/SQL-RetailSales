CREATE TABLE Retail_Sales(
    Transactions_id INT PRIMARY KEY,
    Sale_date DATE,
    Sale_time TIME,
    Customer_id INT,
    Gender VARCHAR(15),
    Age INT,
    Category VARCHAR(15),
    Quantity INT,
    Price_per_unit FLOAT,
    Cogs FLOAT,
    Total_sale FLOAT
);
INSERT INTO Retail_Sales (
        Transactions_id,
        Sale_date,
        Sale_time,
        Customer_id,
        Gender,
        Age,
        Category,
        Quantity,
        Price_per_unit,
        Cogs,
        Total_sale
    )
VALUES (
        180,
        '2022-11-05',
        '10:47:00',
        117,
        'Male',
        41,
        'Clothing',
        3,
        300,
        129,
        900
    ),
    (
        522,
        '2022-07-09',
        '11:00:00',
        52,
        'Male',
        46,
        'Beauty',
        3,
        500,
        145,
        1500
    ),
    (
        559,
        '2022-12-12',
        '10:48:00',
        5,
        'Female',
        40,
        'Clothing',
        4,
        300,
        84,
        1200
    ),
    (
        1180,
        '2022-01-06',
        '08:53:00',
        85,
        'Male',
        41,
        'Clothing',
        3,
        300,
        129,
        900
    ),
    (
        1522,
        '2022-11-14',
        '08:35:00',
        48,
        'Male',
        46,
        'Beauty',
        3,
        500,
        235,
        1500
    ),
    (
        1559,
        '2022-08-20',
        '07:40:00',
        49,
        'Female',
        40,
        'Clothing',
        4,
        300,
        144,
        1200
    ),
    (
        163,
        '2022-10-31',
        '09:38:00',
        144,
        'Female',
        64,
        'Clothing',
        3,
        50,
        23,
        150
    ),
    (
        303,
        '2022-04-22',
        '11:09:00',
        54,
        'Male',
        19,
        'Electronics',
        3,
        30,
        14.7,
        90
    ),
    (
        421,
        '2022-04-08',
        '08:43:00',
        66,
        'Female',
        37,
        'Clothing',
        3,
        500,
        235,
        1500
    ),
    (
        979,
        '2022-05-18',
        '10:18:00',
        6,
        'Female',
        19,
        'Beauty',
        1,
        25,
        10.5,
        25
    ),
    (
        1163,
        '2022-05-04',
        '10:52:00',
        120,
        'Female',
        64,
        'Clothing',
        3,
        50,
        27,
        150
    ),
    (
        1303,
        '2022-03-19',
        '08:59:00',
        58,
        'Male',
        19,
        'Electronics',
        3,
        30,
        15,
        90
    ),
    (
        1421,
        '2022-01-17',
        '07:07:00',
        59,
        'Female',
        37,
        'Clothing',
        3,
        500,
        185,
        1500
    ),
    (
        1979,
        '2022-08-17',
        '11:34:00',
        102,
        'Female',
        19,
        'Beauty',
        1,
        25,
        7.75,
        25
    ),
    (
        610,
        '2022-12-18',
        '06:56:00',
        137,
        'Female',
        26,
        'Beauty',
        2,
        300,
        93,
        600
    ),
    (
        1610,
        '2022-11-23',
        '10:18:00',
        1,
        'Female',
        26,
        'Beauty',
        2,
        300,
        102,
        600
    ),
    (
        32,
        '2022-07-16',
        '09:11:00',
        150,
        'Male',
        30,
        'Beauty',
        3,
        30,
        8.4,
        90
    ),
    (
        231,
        '2022-07-09',
        '07:02:00',
        50,
        'Female',
        23,
        'Clothing',
        3,
        50,
        26.5,
        150
    ),
    (
        683,
        '2022-03-06',
        '10:22:00',
        82,
        'Male',
        38,
        'Beauty',
        2,
        500,
        175,
        1000
    ),
    (
        1032,
        '2022-04-01',
        '08:15:00',
        1,
        'Male',
        30,
        'Beauty',
        3,
        30,
        10.5,
        90
    ),
    (
        1231,
        '2022-01-29',
        '07:05:00',
        12,
        'Female',
        23,
        'Clothing',
        3,
        50,
        23,
        150
    ),
    (
        1683,
        '2022-05-04',
        '07:19:00',
        98,
        'Male',
        38,
        'Beauty',
        2,
        500,
        220,
        1000
    ),
    (
        367,
        '2022-12-30',
        '07:03:00',
        123,
        'Female',
        57,
        'Electronics',
        1,
        50,
        18,
        50
    ),
    (
        391,
        '2022-03-25',
        '07:37:00',
        68,
        'Male',
        19,
        'Beauty',
        2,
        25,
        6.25,
        50
    ),
    (
        432,
        '2022-03-10',
        '11:31:00',
        17,
        'Female',
        NULL,
        'Electronics',
        2,
        500,
        190,
        1000
    ),
    (
        1367,
        '2022-04-15',
        '11:38:00',
        16,
        'Female',
        NULL,
        'Electronics',
        1,
        50,
        15.5,
        50
    ),
    (
        1391,
        '2022-03-01',
        '11:29:00',
        130,
        'Male',
        NULL,
        'Beauty',
        2,
        25,
        9.25,
        50
    ),
    (
        1432,
        '2022-12-25',
        '06:24:00',
        67,
        'Female',
        NULL,
        'Electronics',
        2,
        500,
        245,
        1000
    ),
    (
        150,
        '2022-04-13',
        '08:25:00',
        89,
        'Female',
        NULL,
        'Electronics',
        4,
        30,
        16.2,
        120
    ),
    (
        845,
        '2022-10-27',
        '10:12:00',
        25,
        'Male',
        NULL,
        'Clothing',
        1,
        500,
        145,
        500
    ),
    (
        1150,
        '2022-08-22',
        '10:04:00',
        77,
        'Female',
        NULL,
        'Electronics',
        4,
        30,
        10.2,
        120
    ),
    (
        1845,
        '2022-05-24',
        '07:06:00',
        94,
        'Male',
        NULL,
        'Clothing',
        1,
        500,
        185,
        500
    ),
    (
        797,
        '2022-09-16',
        '06:38:00',
        116,
        'Male',
        NULL,
        'Clothing',
        3,
        25,
        10.75,
        75
    ),
    (
        921,
        '2022-09-28',
        '09:34:00',
        101,
        'Male',
        NULL,
        'Electronics',
        3,
        25,
        8,
        75
    ),
    (
        1797,
        '2022-04-16',
        '11:47:00',
        147,
        'Male',
        40,
        'Clothing',
        3,
        25,
        12.25,
        75
    ),
    (
        1921,
        '2022-02-08',
        '07:01:00',
        77,
        'Male',
        51,
        'Electronics',
        3,
        25,
        7.5,
        75
    ),
    (
        291,
        '2022-11-22',
        '08:29:00',
        15,
        'Male',
        60,
        'Clothing',
        2,
        300,
        126,
        600
    ),
    (
        907,
        '2022-09-02',
        '06:16:00',
        145,
        'Female',
        45,
        'Electronics',
        1,
        25,
        8.5,
        25
    ),
    (
        1291,
        '2022-04-04',
        '11:19:00',
        72,
        'Male',
        60,
        'Clothing',
        2,
        300,
        153,
        600
    ),
    (
        1907,
        '2022-11-17',
        '11:21:00',
        115,
        'Female',
        45,
        'Electronics',
        1,
        25,
        9,
        25
    ),
    (
        860,
        '2022-04-11',
        '08:58:00',
        85,
        'Male',
        63,
        'Clothing',
        4,
        50,
        16,
        200
    ),
    (
        1860,
        '2022-03-12',
        '11:21:00',
        57,
        'Male',
        63,
        'Clothing',
        4,
        50,
        18,
        200
    ),
    (
        184,
        '2022-02-13',
        '06:44:00',
        128,
        'Male',
        31,
        'Electronics',
        4,
        50,
        17,
        200
    ),
    (
        734,
        '2022-03-12',
        '08:54:00',
        77,
        'Female',
        27,
        'Clothing',
        1,
        30,
        15.6,
        30
    ),
    (
        1184,
        '2022-02-12',
        '08:28:00',
        23,
        'Male',
        31,
        'Electronics',
        4,
        50,
        27.5,
        200
    ),
    (
        1734,
        '2022-02-28',
        '08:58:00',
        72,
        'Female',
        27,
        'Clothing',
        1,
        30,
        14.4,
        30
    ),
    (
        225,
        '2022-03-05',
        '07:37:00',
        85,
        'Female',
        57,
        'Beauty',
        4,
        25,
        12.75,
        100
    ),
    (
        679,
        '2022-08-26',
        '08:59:00',
        64,
        'Female',
        18,
        'Beauty',
        NULL,
        NULL,
        NULL,
        NULL
    ),
    (
        746,
        '2022-07-05',
        '11:33:00',
        42,
        'Female',
        33,
        'Clothing',
        NULL,
        NULL,
        NULL,
        NULL
    ),
    (
        1225,
        '2022-02-02',
        '09:51:00',
        137,
        'Female',
        57,
        'Beauty',
        NULL,
        NULL,
        NULL,
        NULL
    ),
    (
        1679,
        '2022-09-23',
        '08:08:00',
        71,
        'Female',
        18,
        'Beauty',
        3,
        30,
        15.3,
        90
    ),
    (
        1746,
        '2022-06-13',
        '07:59:00',
        88,
        'Female',
        33,
        'Clothing',
        3,
        30,
        10.8,
        90
    ),
    (
        3,
        '2022-06-14',
        '07:08:00',
        114,
        'Male',
        50,
        'Electronics',
        1,
        30,
        8.1,
        30
    ),
    (
        464,
        '2022-03-06',
        '11:13:00',
        24,
        'Male',
        38,
        'Electronics',
        2,
        300,
        75,
        600
    ),
    (
        484,
        '2022-03-13',
        '07:52:00',
        135,
        'Female',
        19,
        'Clothing',
        4,
        300,
        75,
        1200
    ),
    (
        591,
        '2022-03-21',
        '08:38:00',
        94,
        'Male',
        53,
        'Electronics',
        4,
        25,
        6.5,
        100
    ),
    (
        1003,
        '2022-01-26',
        '07:59:00',
        80,
        'Male',
        50,
        'Electronics',
        1,
        30,
        15.9,
        30
    ),
    (
        1464,
        '2022-11-13',
        '10:06:00',
        80,
        'Male',
        38,
        'Electronics',
        2,
        300,
        126,
        600
    ),
    (
        1484,
        '2022-11-23',
        '09:29:00',
        22,
        'Female',
        19,
        'Clothing',
        4,
        300,
        147,
        1200
    ),
    (
        1591,
        '2022-09-29',
        '11:00:00',
        62,
        'Male',
        53,
        'Electronics',
        4,
        25,
        7,
        100
    ),
    (
        21,
        '2022-07-11',
        '07:33:00',
        59,
        'Female',
        50,
        'Beauty',
        1,
        500,
        275,
        500
    ),
    (
        708,
        '2022-04-06',
        '08:38:00',
        62,
        'Female',
        43,
        'Beauty',
        3,
        300,
        87,
        900
    ),
    (
        713,
        '2022-04-16',
        '11:43:00',
        39,
        'Male',
        34,
        'Beauty',
        3,
        25,
        11.25,
        75
    ),
    (
        768,
        '2022-06-27',
        '06:50:00',
        58,
        'Female',
        24,
        'Beauty',
        3,
        25,
        10.5,
        75
    ),
    (
        1021,
        '2022-06-11',
        '10:19:00',
        44,
        'Female',
        50,
        'Beauty',
        1,
        500,
        155,
        500
    ),
    (
        1708,
        '2022-02-08',
        '07:47:00',
        41,
        'Female',
        43,
        'Beauty',
        3,
        300,
        162,
        900
    ),
    (
        1713,
        '2022-10-03',
        '10:10:00',
        90,
        'Male',
        34,
        'Beauty',
        3,
        25,
        10.75,
        75
    ),
    (
        1768,
        '2022-07-31',
        '09:52:00',
        85,
        'Female',
        24,
        'Beauty',
        3,
        25,
        8.75,
        75
    ),
    (
        499,
        '2022-04-03',
        '10:52:00',
        15,
        'Male',
        46,
        'Beauty',
        2,
        30,
        16.5,
        60
    ),
    (
        697,
        '2022-12-25',
        '07:52:00',
        152,
        'Male',
        53,
        'Clothing',
        1,
        500,
        200,
        500
    ),
    (
        831,
        '2022-11-30',
        '11:49:00',
        149,
        'Male',
        27,
        'Electronics',
        4,
        25,
        13.75,
        100
    ),
    (
        1499,
        '2022-09-23',
        '09:46:00',
        3,
        'Male',
        46,
        'Beauty',
        2,
        30,
        11.7,
        60
    ),
    (
        1697,
        '2022-12-18',
        '08:22:00',
        54,
        'Male',
        53,
        'Clothing',
        1,
        500,
        265,
        500
    ),
    (
        1831,
        '2022-03-26',
        '10:54:00',
        80,
        'Male',
        27,
        'Electronics',
        4,
        25,
        6.5,
        100
    ),
    (
        15,
        '2022-07-01',
        '11:50:00',
        75,
        'Female',
        42,
        'Electronics',
        4,
        500,
        210,
        2000
    ),
    (
        743,
        '2022-08-07',
        '07:54:00',
        55,
        'Female',
        34,
        'Beauty',
        4,
        500,
        260,
        2000
    ),
    (
        1015,
        '2022-03-09',
        '11:53:00',
        94,
        'Female',
        42,
        'Electronics',
        4,
        500,
        200,
        2000
    ),
    (
        1743,
        '2022-10-26',
        '09:37:00',
        47,
        'Female',
        34,
        'Beauty',
        4,
        500,
        250,
        2000
    ),
    (
        14,
        '2022-05-18',
        '07:11:00',
        8,
        'Male',
        64,
        'Clothing',
        4,
        30,
        13.2,
        120
    ),
    (
        103,
        '2022-11-12',
        '10:05:00',
        33,
        'Female',
        59,
        'Clothing',
        1,
        25,
        10.75,
        25
    ),
    (
        238,
        '2022-05-10',
        '11:52:00',
        20,
        'Female',
        39,
        'Beauty',
        1,
        500,
        150,
        500
    ),
    (
        986,
        '2022-08-01',
        '09:35:00',
        65,
        'Female',
        49,
        'Clothing',
        2,
        500,
        200,
        1000
    ),
    (
        1014,
        '2022-02-04',
        '10:26:00',
        147,
        'Male',
        64,
        'Clothing',
        4,
        30,
        11.4,
        120
    ),
    (
        1103,
        '2022-02-14',
        '07:11:00',
        61,
        'Female',
        59,
        'Clothing',
        1,
        25,
        6.75,
        25
    ),
    (
        1238,
        '2022-09-17',
        '07:38:00',
        129,
        'Female',
        39,
        'Beauty',
        1,
        500,
        165,
        500
    ),
    (
        1986,
        '2022-09-14',
        '08:28:00',
        29,
        'Female',
        49,
        'Clothing',
        2,
        500,
        145,
        1000
    ),
    (
        438,
        '2022-08-31',
        '10:15:00',
        88,
        'Female',
        42,
        'Clothing',
        1,
        30,
        15.9,
        30
    ),
    (
        1438,
        '2022-01-07',
        '10:00:00',
        72,
        'Female',
        42,
        'Clothing',
        1,
        30,
        13.8,
        30
    ),
    (
        475,
        '2022-08-12',
        '10:39:00',
        78,
        'Male',
        26,
        'Clothing',
        3,
        25,
        9,
        75
    );
SELECT COUNT(*)
FROM Retail_Sales --How many entries are there in the database
SELECT *
FROM Retail_Sales
LIMIT 20 --Take the first 20 entries
SELECT *
FROM Retail_Sales
WHERE Transactions_id IS NULL
    OR Sale_date IS NULL
    OR Sale_time IS NULL
    OR Gender IS NULL
    OR Category IS NULL
    OR Quantity IS NULL
    OR Cogs IS NULL
    OR Total_sale IS NULL;
--TO bring all null values from columns
DELETE *
FROM Retail_Sales
WHERE Transactions_id IS NULL
    OR Sale_date IS NULL
    OR Sale_time IS NULL
    OR Gender IS NULL
    OR Category IS NULL
    OR Quantity IS NULL
    OR Cogs IS NULL
    OR Total_sale IS NULL;
--removing all NULL values
--Retrieving Sales from a specific Date
SELECT
FROM Retail_Sales
WHERE Sale_date = '2022-11-05';
--Retrieving where category(clothing)is >4 in month of Nov
SELECT *
FROM Retail_Sales
WHERE Category = 'CLOTHING'
    AND TO_CHAR(Sale_date, 'YYYY-MM' = '2022-11')
    AND Quantity >= 4;
--QUERY to calculate the total sales for each category
SELECT Category SUM(Total_sale) AS Net_sale,
    COUNT(*) AS Total_orders
FROM Retail_Sales
GROUP BY 1;
--QUERY TO FIND AVERAGE AGE OF CUSTOMERS FROM BEAUTY CATEGORY
SELECT AVERAGE(Age) AS Average_age
FROM Retail_Sales
WHERE Category = 'Beauty' --QUERY TO FIND ALL TRANSACTIONS WHERE TOTAL_SALE IS GREATER THAN 1000
SELECT *
FROM Retail_Sales
WHERE Total_sale > 1000 --QUERY to find total no. of transactions made by each gender in each category
SELECT Category,
    Gender,
    COUNT(*) AS Total_transactions
FROM Retail_Sales
GROUP BY Category,
    Gender
ORDER BY 1 --QUERY TO CALCULATE AVG SALE FOR EACH MONTH
SELECT EXTRACT(
        YEAR
        FROM Sale_date
    ) AS Year,
    EXTRACT(
        MONTH
        FROM Sale_date
    ) AS Month,
    AVG(Total_sale) AS Average_sale
FROM Retail_Sales
GROUP BY 1,
    2
ORDER BY 1,
    2,
    3 DESC;
--QUERY to find top 5 customers based on highest total sales
SELECT Customer_id,
    SUM(Total_sale) as Total_sales
FROM Retail_Sales
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5;
--QUERY To find unique customers who purchased from each category
SELECT Category,
    COUNT (DISTINCT Customer_id) AS Unique_Customers
FROM Retail_Sales
GROUP BY Category
